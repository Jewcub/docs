



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Encrypted, recoverable, schema-based, cross-application data storage built on IPFS and LibP2P.">
      
      
        <link rel="canonical" href="https://docs.textile.io/concepts/threads/">
      
      
        <meta name="author" content="textile.io">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.0">
    
    
      
        <title>Introduction - Textile Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.86c34351.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/textile.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="default" data-md-color-accent="default">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#requirements" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.textile.io/" title="Textile Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo_pink.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Textile Documentation
            </span>
            <span class="md-header-nav__topic">
              Introduction
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/textileio/docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    textileio/docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.textile.io/" title="Textile Documentation" class="md-nav__button md-logo">
      
        <img src="../../images/logo_pink.svg" width="48" height="48">
      
    </a>
    Textile Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/textileio/docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    textileio/docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome!" class="md-nav__link">
      Welcome!
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Install
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Install
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/the-daemon/" title="The Daemon" class="md-nav__link">
      The Daemon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/desktop/" title="Desktop" class="md-nav__link">
      Desktop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/apps/" title="Apps" class="md-nav__link">
      Apps
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../a-tour-of-textile/" title="A Tour of Textile" class="md-nav__link">
      A Tour of Textile
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Concepts
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Concepts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../the-wallet/" title="The Wallet" class="md-nav__link">
      The Wallet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../contacts/" title="Contacts" class="md-nav__link">
      Contacts
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4" checked>
    
    <label class="md-nav__link" for="nav-4-4">
      Threads
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        Threads
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Introduction
      </label>
    
    <a href="./" title="Introduction" class="md-nav__link md-nav__link--active">
      Introduction
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" title="Requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" title="Implementation" class="md-nav__link">
    Implementation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model" title="Model" class="md-nav__link">
    Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#orchestration" title="Orchestration" class="md-nav__link">
    Orchestration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outbound-updates" title="Outbound updates" class="md-nav__link">
    Outbound updates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inbound-updates" title="Inbound updates" class="md-nav__link">
    Inbound updates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#account-threads" title="Account Threads" class="md-nav__link">
    Account Threads
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snapshots" title="Snapshots" class="md-nav__link">
    Snapshots
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-control" title="Access Control" class="md-nav__link">
    Access Control
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blocks" title="Blocks" class="md-nav__link">
    Blocks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#files" title="Files" class="md-nav__link">
    Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v2-roadmap" title="V2 Roadmap" class="md-nav__link">
    V2 Roadmap
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="files/" title="Files" class="md-nav__link">
      Files
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cafes/" title="Cafes" class="md-nav__link">
      Cafes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../search/" title="Search" class="md-nav__link">
      Search
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Connectors
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Connectors
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../connectors/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connectors/images/" title="Images & Media" class="md-nav__link">
      Images & Media
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connectors/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Develop
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Develop
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">
    
    <label class="md-nav__link" for="nav-6-1">
      Clients
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        Clients
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/clients/command-line/" title="Command-line" class="md-nav__link">
      Command-line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/clients/javascript/" title="JavaScript" class="md-nav__link">
      JavaScript
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/clients/react-native/" title="React Native" class="md-nav__link">
      React Native
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/clients/ios/" title="iOS" class="md-nav__link">
      iOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/clients/android/" title="Android" class="md-nav__link">
      Android
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/the-http-api/" title="The HTTP API" class="md-nav__link">
      The HTTP API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/ipfs-gateway/" title="IPFS Gateway" class="md-nav__link">
      IPFS Gateway
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/peer-config-file/" title="Peer Config File" class="md-nav__link">
      Peer Config File
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Policies
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Policies
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../policies/code-of-conduct/" title="Code of Conduct" class="md-nav__link">
      Code of Conduct
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policies/privacy-policy/" title="Privacy Policy" class="md-nav__link">
      Privacy Policy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policies/terms-of-service/" title="Terms of Service" class="md-nav__link">
      Terms of Service
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policies/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" title="Requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" title="Implementation" class="md-nav__link">
    Implementation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model" title="Model" class="md-nav__link">
    Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#orchestration" title="Orchestration" class="md-nav__link">
    Orchestration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outbound-updates" title="Outbound updates" class="md-nav__link">
    Outbound updates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inbound-updates" title="Inbound updates" class="md-nav__link">
    Inbound updates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#account-threads" title="Account Threads" class="md-nav__link">
    Account Threads
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snapshots" title="Snapshots" class="md-nav__link">
    Snapshots
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-control" title="Access Control" class="md-nav__link">
    Access Control
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blocks" title="Blocks" class="md-nav__link">
    Blocks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#files" title="Files" class="md-nav__link">
    Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v2-roadmap" title="V2 Roadmap" class="md-nav__link">
    V2 Roadmap
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/textileio/docs/edit/master/docs/concepts/threads/index.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Introduction</h1>
                
                <p><em>Threads</em> are the backbone of Textile's <em>encrypted, recoverable, schema-based, and cross-application data storage</em>. Think of a thread as a decentralized database of encrypted files and messages, shared between specific participants.</p>
<p>At the core of every thread is a secret. Only peers that possess the secret can decrypt thread content or follow linkages.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Unlike a blockchain, threads are not based around the idea of consensus. Instead, they follow an agent-centric approach similar to <a href="https://holochain.org/">holochain</a>. Each peer has authority over thread access-control and storage.</p>
</div>
<p>Because threads are simply a hash-chain of update messages, or <a href="#blocks">blocks</a>, they can represent any type of dataset. Some blocks point to off-chain data stored on IPFS. For example, a set of photos, a PDF, or even an entire website. Application developers are able to add structure to threads and make them interoperable with other applications by using <a href="/concepts/threads/files#schemas">schemas</a>.</p>
<p>Threads are auto-magically synced with other account peers. For example, you may have one peer on your phone, and another on your laptop, both with access to the same account seed (more about accounts <a href="/concepts/the-wallet#accounts">here</a>). Threads can also be shared with other non-account peers (other users). In any case, each peer maintains a copy of its threads. A p2p messaging protocol keeps all the copies in sync.</p>
<p>The special hash-chain or graph structure of a thread allows them to be easily shared with other peers and backed-up to <a href="/concepts/cafes">cafes</a>. Given one message, you can find all the others.</p>
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h2>
<p>Threads are supposed to serve a decentralized cloud-like function for safely storing and retrieving data generated by applications for users, i.e., photos, messages, contacts, health data, etc. They were designed with the following requirements in mind:</p>
<ul>
<li>Conflict resistant: Similar to <a href="https://github.com/orbitdb/ipfs-log"><code>ipfs-log</code></a>, a thread should facilitate a resilient, distributed state, shared among multiple members (and/or devices).</li>
<li>Mud puddle resistant: There should be a way to safely backup a thread's state such that the owner can recover it.</li>
<li>Offline-first: Because most people access the internet primarily from mobile devices, threads must enable a UX that works well in scenarios where connectivity is spotty, and peers are continually coming and going from the network.</li>
<li>Secure: Peers must sign updates and encrypted with the shared key. Ideally, linkages should also be obscured by encryption.</li>
</ul>
<h2 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h2>
<p>On the one hand, threads is a data model for representing a dataset as a hash-chain of updates. On the other hand, it's a protocol for orchestrating that state between peers.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Threads aim to be language and platform agnostic. For this reason, Textile uses <a href="https://developers.google.com/protocol-buffers/">protocol buffers</a> extensively because they are a "language-neutral, platform-neutral, extensible mechanism for serializing structured data".</p>
</div>
<h3 id="model">Model<a class="headerlink" href="#model" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="nx">message</span> <span class="nx">Thread</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="nx">id</span>                 <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">key</span>                <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="nx">bytes</span> <span class="nx">sk</span>                  <span class="p">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">name</span>               <span class="p">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">schema</span>             <span class="p">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">initiator</span>          <span class="p">=</span> <span class="mi">6</span><span class="p">;</span>
    <span class="nx">Type</span> <span class="kd">type</span>                 <span class="p">=</span> <span class="mi">7</span><span class="p">;</span>
    <span class="nx">Sharing</span> <span class="nx">sharing</span>           <span class="p">=</span> <span class="mi">8</span><span class="p">;</span>
    <span class="nx">repeated</span> <span class="kt">string</span> <span class="nx">whitelist</span> <span class="p">=</span> <span class="mi">9</span><span class="p">;</span>
    <span class="nx">State</span> <span class="nx">state</span>               <span class="p">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">head</span>               <span class="p">=</span> <span class="mi">11</span><span class="p">;</span>

    <span class="c1">// Type controls read (R), annotate (A), and write (W) access</span>
    <span class="nx">enum</span> <span class="nx">Type</span> <span class="p">{</span>
        <span class="nx">PRIVATE</span>   <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// initiator: RAW, whitelist:</span>
        <span class="nx">READ_ONLY</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// initiator: RAW, whitelist: R</span>
        <span class="nx">PUBLIC</span>    <span class="p">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// initiator: RAW, whitelist: RA</span>
        <span class="nx">OPEN</span>      <span class="p">=</span> <span class="mi">3</span><span class="p">;</span> <span class="c1">// initiator: RAW, whitelist: RAW</span>
    <span class="p">}</span>

    <span class="c1">// Sharing controls if (Y/N) a thread can be shared</span>
    <span class="nx">enum</span> <span class="nx">Sharing</span> <span class="p">{</span>
        <span class="nx">NOT_SHARED</span>  <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// initiator: N, whitelist: N</span>
        <span class="nx">INVITE_ONLY</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// initiator: Y, whitelist: N</span>
        <span class="nx">SHARED</span>      <span class="p">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// initiator: Y, whitelist: Y</span>
    <span class="p">}</span>

    <span class="c1">// State indicates the loading state</span>
    <span class="nx">enum</span> <span class="nx">State</span> <span class="p">{</span>
        <span class="nx">LOADING_TAIL</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// tail blocks are being loaded</span>
        <span class="nx">LOADED</span>       <span class="p">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// blocks are all loaded / paused</span>
        <span class="nx">LOADING_HEAD</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// head block is being loaded</span>
    <span class="p">}</span>

    <span class="c1">// view info</span>
    <span class="nx">Block</span> <span class="nx">head_block</span>  <span class="p">=</span> <span class="mi">101</span><span class="p">;</span>
    <span class="nx">Node</span> <span class="nx">schema_node</span>  <span class="p">=</span> <span class="mi">102</span><span class="p">;</span>
    <span class="kt">int32</span> <span class="nx">block_count</span> <span class="p">=</span> <span class="mi">103</span><span class="p">;</span>
    <span class="kt">int32</span> <span class="nx">peer_count</span>  <span class="p">=</span> <span class="mi">104</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<h3 id="orchestration">Orchestration<a class="headerlink" href="#orchestration" title="Permanent link">&para;</a></h3>
<p>The orchestration of thread state between peers can be thought of as syncing a graph of <a href="#blocks">blocks</a> and <a href="/concepts/threads/files">files</a>, which involves sending outbound updates and reading inbound updates. In practice, this is handled by a <a href="https://github.com/libp2p/go-libp2p">libp2p</a> service.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The thread service's protocol ID is <code>/textile/threads/&lt;version&gt;</code>.</p>
</div>
<h4 id="outbound-updates">Outbound updates<a class="headerlink" href="#outbound-updates" title="Permanent link">&para;</a></h4>
<ol>
<li>A <a href="#blocks">block</a> describing an update to a thread is signed with the author's private key and encrypted with the thread secret.</li>
<li>The resulting message is then sent over directly to known participants.</li>
<li>If a peer is offline, the message is again encrypted with their public key and delivered to their <a href="/concepts/cafes/#message-inbox-ing">cafe inbox(es)</a>.</li>
</ol>
<h4 id="inbound-updates">Inbound updates<a class="headerlink" href="#inbound-updates" title="Permanent link">&para;</a></h4>
<ol>
<li>Upon receiving an update, either directly or from a <a href="/concepts/cafes/#message-inbox-ing">cafe inbox</a>, a peer will decrypt, verify, and locally index the inner <a href="#blocks">block</a>.</li>
<li>Depending on thread behavior, the peer will follow the graph, downloading linked messages from the network until it no longer finds new blocks.</li>
<li>Ideally, the update can be fast-forwarded merged, but a deterministic <a href="https://www.atlassian.com/git/tutorials/using-branches/git-merge">3-way merge</a> may be needed.</li>
<li><a href="/concepts/threads/files">Files</a> DAG node referenced by the graph also need to be synced. Sync is handled by first downloading the thread's schema, which contains pinning (storage) instructions for the DAG's inner files.</li>
<li>Finally, a peer may send back an acknowledgment to the author containing <em>its</em> latest graph tip (or HEAD in git terminology) if it believes they have diverged.</li>
</ol>
<h2 id="account-threads">Account Threads<a class="headerlink" href="#account-threads" title="Permanent link">&para;</a></h2>
<p><a href="/concepts/#account-peers">Account peers</a> can instruct each other to create and delete threads by communicating over a special internal <em>account</em> thread. An additional signature is used to handle this on outbound updates, which differentiates account and non-account peer messages.</p>
<p>The account thread is used to track account peers, profile information, and known contacts. Like normal threads, it is kept in sync between account peers. Read more about account sync <a href="/concepts/the-wallet#sync">here</a>.</p>
<h2 id="snapshots">Snapshots<a class="headerlink" href="#snapshots" title="Permanent link">&para;</a></h2>
<p>Thread snapshots enable <a href="/concepts/the-wallet#sync">account sync</a>, recovery, and login from new devices. Snapshots are an encrypted representation of a thread. They contain metadata and the latest update hash, which is usually stored by <a href="/concepts/cafes">cafes</a>. Account peers will continuously <a href="/concepts/search">search</a> for, decrypt, and apply one another's snapshots to their local thread state.</p>
<h2 id="access-control">Access Control<a class="headerlink" href="#access-control" title="Permanent link">&para;</a></h2>
<p>Control over thread access and sharing is handled by a combination of the <em>type</em> and <em>sharing</em> settings. An immutable member address "whitelist" gives the initiator fine-grained control. The table below outlines access patterns for the thread initiator and the whitelist members. An empty whitelist is taken to be "everyone", which is the default.</p>
<p>Thread <em>type</em> controls read (R), annotate (A), and write (W) access:</p>
<div class="codehilite"><pre><span></span>private   --&gt; initiator: RAW, whitelist:
read_only --&gt; initiator: RAW, whitelist: R
public    --&gt; initiator: RAW, whitelist: RA
open      --&gt; initiator: RAW, whitelist: RAW
</pre></div>

<p>Thread <em>sharing</em> style controls if (Y/N) a thread can be shared:</p>
<div class="codehilite"><pre><span></span>not_shared  --&gt; initiator: N, whitelist: N
invite_only --&gt; initiator: Y, whitelist: N
shared      --&gt; initiator: Y, whitelist: Y`
</pre></div>

<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Access control will be moving to a more familiar, <em>role-based</em> design in a future release. See <a href="https://github.com/textileio/go-textile/issues/694">this GitHub issue</a> for more.</p>
</div>
<h2 id="blocks">Blocks<a class="headerlink" href="#blocks" title="Permanent link">&para;</a></h2>
<p>Blocks are the raw components of a thread. Think of them as an append-only log of thread updates where each one is hash-linked to its parent(s), forming a tree. New / recovering peers can sync history by merely traversing the hash tree.</p>
<p>In practice, blocks are small (encrypted) <a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>, linked together by their IPFS CID (content id or hash). You can explore the protocol buffer definitions <a href="https://github.com/textileio/textile-go/tree/master/pb/protos">here</a>.</p>
<p>There are several block types:</p>
<div class="codehilite"><pre><span></span>-  MERGE:    3-way merge added.
-  IGNORE:   A block was ignored.
-  FLAG:     A block was flagged.
-  JOIN:     Peer joined.
-  ANNOUNCE: Peer set username / avatar / inbox addresses
-  LEAVE:    Peer left.
-  TEXT:     Text message added.
-  FILES:    File(s) added.
-  COMMENT:  Comment added to another block.
-  LIKE:     Like added to another block.
</pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The Blocks API can serve <a href="https://www.graphviz.org/">Graphviz</a> dot files which can be converted to an image as seen below. See <code>textile blocks --help</code> for more)</p>
</div>
<details class="example" open="open"><summary>A chat thread</summary><p><img alt="" class="center" src="/images/blocks_s.png" /></p>
</details>
<details class="example" open="open"><summary>An account thread shared between eight peers</summary><p><img alt="" class="center" src="/images/account_blocks.png" /></p>
</details>
<h2 id="files">Files<a class="headerlink" href="#files" title="Permanent link">&para;</a></h2>
<p>The <code>FILES</code> block type points to off-thread data in the form of an <a href="https://ipld.io/">IPLD</a> merkle DAG. These DAGs are described by and validated against the thread's <a href="/concepts/threads/files#schemas"><em>schema</em></a>.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Any data added to a thread ends up as a <a href="/concepts/threads/files"><em>file</em></a>, regardless of whether or not the source data was an actual file. For example, echoing a string into a thread results in a "file" containing that string.</p>
</div>
<p>Read more about files in <a href="/concepts/threads/files">the next section</a>.</p>
<h2 id="v2-roadmap">V2 Roadmap<a class="headerlink" href="#v2-roadmap" title="Permanent link">&para;</a></h2>
<p>Work on the next version of threads (v2) has started. The goals and individual issues for the next version can be seen <a href="https://github.com/textileio/go-textile/issues/748">here</a>. The high-level goals have been copied below:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Move to a standalone GitHub repository.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Add the notion of "intent" to the data model so that other applications can understand a threads intended purpose.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Replace the protocol buffer based linkages with IPLD so other programs can more easily traverse threads.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Use a hybrid p2p and gossipsub orchestration pattern (details to come).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Break HEAD into multiple categories (peers, content, annotations)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Move to a role-based access model for accounts and applications.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Encrypt thread snapshots with one-off keys that can be provisioned w/ rolls.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Allow threads to be searchable and "followed" from a gateway.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Support a more traditional "feed" mechanism (1-&gt;many vs. some-&gt;some).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Use a single AES key as the thread secret, hash of key as ID.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> In addition to being governed by access role, peers should not be required to download thread history.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Local thread interactions should use the more human-readable key and not id.</li>
</ul>
<div class="admonition hint">
<p class="admonition-title">Feedback welcome!</p>
<p>Please <a href="mailto:contact@textile.io">let us know</a> if you want to weigh in on the next version of threads.</p>
</div>
<p><br></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../contacts/" title="Contacts" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Contacts
              </span>
            </div>
          </a>
        
        
          <a href="files/" title="Files" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Files
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; Textile
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://textile.io" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/textileio" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/textileio" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://medium.com/textileio" class="md-footer-social__link fa fa-medium"></a>
    
      <a href="https://slack.textile.io" class="md-footer-social__link fa fa-slack"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.12aa63bf.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/sidebar.js"></script>
      
        <script src="../../search/main.js"></script>
      
    
  </body>
</html>